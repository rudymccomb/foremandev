# Auto-generated by Puppet with sys::ubuntu::network.  Modify at own risk.
#
# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
<% lo_if = @interfaces.fetch('lo', {}).merge(@defaults['lo']) -%>
iface lo <%= lo_if['family'] %> <%= lo_if['method'] %>

<% for interface in @interfaces.keys.sort -%>
<%# Skip lo if in interfaces, already configured above -%>
<%   if interface == 'lo' -%>
<%     next -%>
<%   end -%>
<%   iface = @interfaces[interface] -%>
<%   address = iface.fetch('address', nil) -%>
<%   family = iface.fetch('family', @defaults['family']) -%>
<%   gateway = iface.fetch('gateway', nil) -%>
<%   method = iface.fetch('method', @defaults['method']) -%>
<%   nameserver = iface.fetch('nameserver', nil) -%>
<%   domain = iface.fetch('domain', nil) -%>
<%   search = iface.fetch('search', nil) -%>
<%   sortlist = iface.fetch('sortlist', nil) -%>
auto <%= interface %>
iface <%= interface %> <%= family %> <%= method %>
<%   if address -%>
    address <%= address %>
    netmask <%= iface.fetch('netmask', @defaults['netmask']) %>
<%   end -%>
<%   if gateway -%>
    gateway <%= gateway %>
<%   end -%>
<%   if nameserver.is_a? Array -%>
    dns-nameservers <%= nameserver.join(' ') %>
<%   elsif nameserver -%>
    dns-nameservers <%= nameserver %>
<% end -%>
<%# The domain and search options are mutually exclusive -%>
<%   if domain -%>
     dns-domain <%= domain %>
<%   elsif search.is_a? Array -%>
    dns-search <%= search.join(' ') %>
<%   elsif search -%>
    dns-search <%= search %>
<%   end -%>
<%# For any DNS sorting lists in resolv.conf -%>
<%   if sortlist.is_a? Array -%>
    dns-sortlist <%= sortlist.join(' ') %>
<%   elsif sortlist -%>
    dns-sortlist <%= sortlist %>
<%   end -%>
<% end -%>
